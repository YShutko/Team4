```markdown
# Developer Specification: Automated Screenshot → PPTX Pipeline  
**Version:** v1  
**Author:** James Barlow / Dev Automation  
**Purpose:** Automate the capture of development artifacts (local websites, Streamlit apps, code/notebook outputs) and compile them into a repeatable, programmatically generated PowerPoint presentation.

---

## 1. Overview

This specification defines a Python-based automation pipeline that:

1. **Captures screenshots** from:
   - Locally hosted web applications (e.g., Streamlit running on `localhost:8501`)
   - HTML-rendered notebooks or code snippets
   - Pre-rendered matplotlib figures or data visualizations
2. **Processes screenshots** and stores them in a consistent project structure.
3. **Generates a PowerPoint (.pptx) file** using `python-pptx`, placing the screenshots into predefined slide layouts.
4. Provides a **repeatable build flow** (`make slides`) so developers can refresh the entire deck in one command.

---

## 2. System Components

### 2.1 Headless Browser Screenshot Engine  
**Library:** Playwright for Python  
**Purpose:** Capture screenshots of local web UIs.

**Requirements:**
```bash
pip install playwright
playwright install
```

**Key Capabilities:**
- Launch Chromium in headless mode.
- Navigate to a localhost URL.
- Wait for full render (`wait_until="networkidle"`).
- Capture full-page PNG at configurable resolution.

**Example API:**
```python
def screenshot_local(url: str, out_path: str, width=1280, height=720)
```

---

### 2.2 Code/Notebook Screenshot Capture

**Two supported paths:**

1. **Direct export:**
   - Matplotlib figures (`fig.savefig("...")`)
   - Plotly static images
2. **Rendered HTML screenshot (Playwright):**
   - Convert notebook → HTML via `nbconvert`
   - Use screenshot_local() on the generated file

**Optional Enhancement:**
- Syntax highlight code via `pygments`
- Render to HTML
- Screenshot

---

### 2.3 Image Processing Layer (Optional)

**Library:** Pillow (`PIL`)  
**Purpose:** Add metadata overlays (timestamp, git hash, titles).  
**Functionality (optional):**
- Annotate PNGs with text
- Add semi-transparent footer bars
- Resize or normalize aspect ratios

---

### 2.4 PPTX Generator

**Library:** python-pptx  
**Purpose:** Assemble a final deck using stored screenshots.

**Key Features:**
- Use template `.pptx` with predefined layouts (recommended)
- Insert PNGs into blank or pre-titled slides
- Maintain consistent spacing, aspect ratio, and margin handling

**Example API:**
```python
def build_deck(image_paths, template_path=None, out_path="report.pptx"):
```

---

## 3. File/Directory Structure

```
project/
    screens/
        streamlit-home.png
        streamlit-page1.png
        admin-panel.png
        code-snippet.png
        notebook-cell.png
    capture_screens.py
    build_pptx.py
    Makefile
    templates/
        base_deck.pptx
    output/
        dev-artifacts-report.pptx
```

- `screens/` → all autogenerated images
- `templates/` → optional PPTX templates
- `output/` → compiled presentations

---

## 4. Detailed Workflow

### Step 1 — Capture Screens

**capture_screens.py** runs all screenshot logic:

```python
from playwright.sync_api import sync_playwright

def screenshot_local(url, out_path, width=1280, height=720):
    with sync_playwright() as p:
        browser = p.chromium.launch(headless=True)
        page = browser.new_page(viewport={"width": width, "height": height})
        page.goto(url, wait_until="networkidle")
        page.wait_for_timeout(2000)
        page.screenshot(path=out_path, full_page=True)
        browser.close()

def main():
    screenshot_local("http://localhost:8501", "screens/streamlit-home.png")
    screenshot_local("http://localhost:8501/?view=page1", "screens/streamlit-page1.png")
    # Additional captures for notebooks, code, charts, etc.

if __name__ == "__main__":
    main()
```

---

### Step 2 — Build PPTX

**build_pptx.py**

```python
from pptx import Presentation
from pptx.util import Inches

def build_deck(image_paths, template_path=None, out_path="dev-artifacts-report.pptx"):
    prs = Presentation(template_path) if template_path else Presentation()
    blank = prs.slide_layouts[6]

    for img in image_paths:
        slide = prs.slides.add_slide(blank)
        left, top, height = Inches(1), Inches(1), Inches(5)
        slide.shapes.add_picture(img, left, top, height=height)

    prs.save(out_path)

if __name__ == "__main__":
    imgs = [
        "screens/streamlit-home.png",
        "screens/streamlit-page1.png",
        # add more
    ]
    build_deck(imgs)
```

---

## 5. Command-Line + Makefile Integration

### Makefile

```make
screens:
	python capture_screens.py

slides: screens
	python build_pptx.py

all: slides
```

### Usage

```
make slides
```

This regenerates all screenshots and compiles the updated PowerPoint deck.

---

## 6. Future Enhancements

- **Stateful Streamlit URLs** for reproducible view capture  
- **Metadata overlays** using Pillow (timestamp, version, environment)  
- **Slide indexing/layouts** mapped from YAML config  
- **CI automation** to generate a deck on every tagged commit  
- **Animated GIF screenshots** (e.g., for micro-interactions)

---

## 7. Dependencies Summary

| Component         | Library           | Purpose                                |
|------------------|-------------------|----------------------------------------|
| Screenshot engine | Playwright        | Capture local web UI images            |
| PPTX generator    | python-pptx       | Build presentation                      |
| Image processing  | Pillow (optional) | Watermarks, metadata, resizing          |
| Notebook export   | nbconvert         | Render Jupyter to HTML                  |
| Syntax highlighting | pygments        | HTML code rendering                     |

---

## 8. Acceptance Criteria

- Running `make slides` must:
  - Launch a headless browser
  - Capture all defined screenshots into `screens/`
  - Generate a `.pptx` containing each screenshot on its own slide
  - Overwrite any previous output deck

- All scripts must:
  - Run cross-platform (Mac/Linux/Windows)
  - Require minimal configuration
  - Fail gracefully if a service is not reachable

---

## 9. Deliverables

- `capture_screens.py`
- `build_pptx.py`
- `Makefile`
- `templates/base_deck.pptx`
- `README.md` (this spec)
```
